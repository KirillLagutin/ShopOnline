@page "/Categories"

@inherits CategoriesBase

<PageTitle>Categories</PageTitle>

<h3 class="mb-5">Product List</h3>

@if (Products != null)
{
    var productCount = Products.Count();

    if (productCount > 0)
    {
        var groupedProductsByCategory 
            = from product in Products
            group product by product.CategoryId
            into prodByCatGroup
            orderby prodByCatGroup.Key
            select prodByCatGroup;

        @foreach (var prodGroup in groupedProductsByCategory)
        {
            <h4>
                @ProductCategories.First(pc => 
                    pc.Id == prodGroup.First().CategoryId).Name
            </h4>
                                                                                 
            <div class="row mt-3">
                
                @foreach (var item in prodGroup)
                {
                    <ProductItem Product="item"/>
                }
                
            </div>
            
            <hr class="mb-3"/>
        }
    }
}
else
{
    <p>Loading...</p>
}